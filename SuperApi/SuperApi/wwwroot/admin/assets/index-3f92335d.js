import{_ as j}from"./refresh-83571ede.js";import{_ as I}from"./round-plus-f1fff6bd.js";import{a as Q,e as X,d as Y,g as G}from"./dynamic-41b1b26f.js";import{d as V,r as g,c as A,bt as R,w as q,aO as C,aR as B,aS as o,aX as e,aY as y,ae as P,b3 as H,aQ as O,aP as L,aV as J,a$ as K,aT as v,b4 as W,aU as Z,bf as ee,bF as te}from"./index-e9ed0e0e.js";import{u as ne}from"./use-loading-62d2aacf.js";import{c as F,f as ae,a as oe}from"./rule-7c323978.js";import{_ as le}from"./FormItemGridItem-6f6a168c.js";import{_ as se}from"./Input-dd6f5e07.js";import{_ as ie}from"./Select-227e2db3.js";import{a as ce}from"./Grid-034146f3.js";import{_ as N}from"./Space-5f39c62b.js";import{V as ue,_ as pe}from"./vuedraggable.umd-8dbe5ada.js";import{_ as de}from"./setting-outlined-7a04a85c.js";import{_ as re}from"./Checkbox-98c4e004.js";import{c as _e}from"./Popover-0534a616.js";import{N as me}from"./Tag-b8d65896.js";import{N as fe}from"./Popconfirm-d647cf5b.js";import{_ as ve}from"./DataTable-281d2743.js";import"./format-length-c9d165c6.js";import"./get-c6b7aef5.js";import"./Suffix-bca8596e.js";import"./use-merged-state-496c4ad7.js";import"./use-compitable-74186af3.js";import"./cssr-11db33b0.js";import"./next-frame-once-7035a838.js";import"./Dropdown-a3ff842e.js";const ge=V({name:"TableActionModal",__name:"table-action-modal",props:{visible:{type:Boolean},type:{default:"add"},editData:{default:null}},setup($,{emit:h}){const u=$,x=g([{label:"未过期",value:2},{label:"已过期",value:1}]),k=g([{label:"MySql",value:0},{label:"SqlServer",value:1},{label:"Sqlite",value:2},{label:"Oracle",value:3},{label:"PostgreSQL",value:4}]),d=A({get(){return u.visible},set(c){h("update:visible",c)}}),m=()=>{d.value=!1},w=A(()=>({add:"添加用户",edit:"编辑用户"})[u.type]),r=g(),t=R(S()),T={account:F("请输入用户名"),nickName:F("请输入年龄"),phone:ae.phone};function S(){return{id:0,account:"",nickName:"",phone:"",host:"",dbType:"",connAccount:"",connPassword:"",isExpire:0}}function p(c){Object.assign(t,c)}function U(){({add:()=>{const a=S();p(a)},edit:()=>{u.editData&&p(u.editData)}})[u.type]()}async function z(){var a,_,s;await((a=r.value)==null?void 0:a.validate());const c={id:t.id,account:t.account,nickName:t.nickName,phone:t.phone,host:t.host,dbType:t.dbType,connAccount:t.connAccount,connPassword:t.connPassword,isExpire:t.isExpire.toString()};u.type=="add"&&(await Q(c)).data.code===200&&((_=window.$message)==null||_.success("新增成功!")),u.type=="edit"&&(await X(c)).data.code===200&&((s=window.$message)==null||s.success("修改成功!")),h("refresh"),m()}return q(()=>u.visible,c=>{c&&U()}),(c,a)=>{const _=se,s=le,b=ie,n=ce,i=P,f=N,D=oe,E=H;return C(),B(E,{show:d.value,"onUpdate:show":a[8]||(a[8]=l=>d.value=l),preset:"card",title:w.value,class:"w-700px"},{default:o(()=>[e(D,{ref_key:"formRef",ref:r,"label-placement":"left","label-width":120,model:t,rules:T},{default:o(()=>[e(n,{cols:24,"x-gap":18},{default:o(()=>[e(s,{span:12,label:"账号",path:"account"},{default:o(()=>[e(_,{value:t.account,"onUpdate:value":a[0]||(a[0]=l=>t.account=l)},null,8,["value"])]),_:1}),e(s,{span:12,label:"昵称",path:"nickName"},{default:o(()=>[e(_,{value:t.nickName,"onUpdate:value":a[1]||(a[1]=l=>t.nickName=l)},null,8,["value"])]),_:1}),e(s,{span:12,label:"手机号",path:"phone"},{default:o(()=>[e(_,{value:t.phone,"onUpdate:value":a[2]||(a[2]=l=>t.phone=l)},null,8,["value"])]),_:1}),e(s,{span:12,label:"是否付费",path:"isExpire"},{default:o(()=>[e(b,{value:t.isExpire,"onUpdate:value":a[3]||(a[3]=l=>t.isExpire=l),options:x.value},null,8,["value","options"])]),_:1}),e(s,{span:12,label:"数据库IP",path:"host"},{default:o(()=>[e(_,{value:t.host,"onUpdate:value":a[4]||(a[4]=l=>t.host=l)},null,8,["value"])]),_:1}),e(s,{span:12,label:"数据库类型",path:"dbType"},{default:o(()=>[e(b,{value:t.dbType,"onUpdate:value":a[5]||(a[5]=l=>t.dbType=l),options:k.value},null,8,["value","options"])]),_:1}),e(s,{span:12,label:"数据库账号",path:"connAccount"},{default:o(()=>[e(_,{value:t.connAccount,"onUpdate:value":a[6]||(a[6]=l=>t.connAccount=l)},null,8,["value"])]),_:1}),e(s,{span:12,label:"数据库密码",path:"connPassword"},{default:o(()=>[e(_,{value:t.connPassword,"onUpdate:value":a[7]||(a[7]=l=>t.connPassword=l)},null,8,["value"])]),_:1})]),_:1}),e(f,{class:"w-full pt-16px",size:24,justify:"end"},{default:o(()=>[e(i,{class:"w-72px",onClick:m},{default:o(()=>[y("取消")]),_:1}),e(i,{class:"w-72px",type:"primary",onClick:z},{default:o(()=>[y("确定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title"])}}}),be={class:"w-180px"},ye={key:0,class:"flex-y-center h-36px px-12px hover:bg-primary_active"},he=V({__name:"column-setting",props:{columns:{}},emits:["update:columns"],setup($,{emit:h}){const u=$,x=g(k());function k(){return u.columns.map(d=>({...d,checked:!0}))}return q(x,d=>{const w=d.filter(r=>r.checked).map(r=>{const t={...r};return delete t.checked,t});h("update:columns",w)},{deep:!0}),(d,m)=>{const w=de,r=P,t=pe,T=re,S=_e;return C(),B(S,{placement:"bottom",trigger:"click"},{trigger:o(()=>[e(r,{size:"small",type:"primary"},{default:o(()=>[e(w,{class:"mr-4px text-16px"}),y(" 表格列设置 ")]),_:1})]),default:o(()=>[O("div",be,[e(v(ue),{modelValue:x.value,"onUpdate:modelValue":m[0]||(m[0]=p=>x.value=p),"item-key":"key"},{item:o(({element:p})=>[p.key?(C(),L("div",ye,[e(t,{class:"mr-8px text-20px cursor-move"}),e(T,{checked:p.checked,"onUpdate:checked":U=>p.checked=U},{default:o(()=>[y(J(p.title),1)]),_:2},1032,["checked","onUpdate:checked"])])):K("",!0)]),_:1},8,["modelValue"])])]),_:1})}}}),xe={class:"overflow-hidden"},ke={class:"flex-col h-full"},He=V({__name:"index",setup($){const{loading:h,startLoading:u,endLoading:x}=ne(!1),{bool:k,setTrue:d}=W(),m=g([]);function w(n){m.value=n}async function r(){u();const n=await G({...s});n.data.code===200&&(w(n.data.data.list),x())}const t=g([{label:"MySql",value:0},{label:"SqlServer",value:1},{label:"Sqlite",value:2},{label:"Oracle",value:3},{label:"PostgreSQL",value:4}]),T=g([{type:"selection",align:"center"},{key:"index",title:"序号",align:"center",render:(n,i)=>`${i+1}`},{key:"account",title:"账号",align:"center"},{key:"nickName",title:"昵称",align:"center"},{key:"phone",title:"手机号码",align:"center",width:180},{key:"host",title:"数据库IP",align:"center"},{key:"dbType",title:"数据库类型",align:"center",render:n=>{const i=t.value.findIndex(f=>f.value==n.dbType);return i>-1?t.value[i].label:""}},{key:"connAccount",title:"数据库账号",align:"center"},{key:"connPassword",title:"数据库密码",align:"center"},{key:"isExpire",title:"是否过期",align:"center",render:n=>e(me,{type:{2:"success",1:"error"}[n.isExpire]},{default:()=>[n.isExpire==2?"未过期":"已过期"]})},{key:"actions",title:"操作",align:"center",width:200,render:n=>e(N,{justify:"center"},{default:()=>[e(P,{size:"small",onClick:()=>a(n.id)},{default:()=>[y("编辑")]}),e(fe,{onPositiveClick:()=>_(n.id)},{default:()=>"确认删除",trigger:()=>e(P,{size:"small"},{default:()=>[y("删除")]})})]})}]),S=g("add");function p(n){S.value=n}const U=g(null);function z(n){U.value=n}function c(){d(),p("add")}function a(n){const i=m.value.find(f=>f.id===n);i&&z(i),p("edit"),d()}async function _(n){var f;(await Y({id:n})).data.code===200&&((f=window.$message)==null||f.success("删除成功!"),b())}const s=R({page:1,pageSize:10,showSizePicker:!0,pageSizes:[10,15,20,25,30],onChange:n=>{s.page=n},onUpdatePageSize:n=>{s.pageSize=n,s.page=1}});function b(){r()}return b(),(n,i)=>{const f=I,D=j,E=ve,l=te;return C(),L("div",xe,[e(l,{title:"用户管理",bordered:!1,class:"h-full rounded-8px shadow-sm"},{default:o(()=>[O("div",ke,[e(v(N),{class:"pb-12px",justify:"space-between"},{default:o(()=>[e(v(N),null,{default:o(()=>[e(v(P),{type:"primary",onClick:c},{default:o(()=>[e(f,{class:"mr-4px text-20px"}),y(" 新增 ")]),_:1})]),_:1}),e(v(N),{align:"center",size:18},{default:o(()=>[e(v(P),{size:"small",type:"primary",onClick:r},{default:o(()=>[e(D,{class:Z(["mr-4px text-16px",{"animate-spin":v(h)}])},null,8,["class"]),y(" 刷新表格 ")]),_:1}),e(he,{columns:T.value,"onUpdate:columns":i[0]||(i[0]=M=>T.value=M)},null,8,["columns"])]),_:1})]),_:1}),e(E,{columns:T.value,data:m.value,remote:"",loading:v(h),pagination:s,"flex-height":"",class:"flex-1-hidden"},null,8,["columns","data","loading","pagination"]),e(ge,{onRefresh:b,visible:v(k),"onUpdate:visible":i[1]||(i[1]=M=>ee(k)?k.value=M:null),type:S.value,"edit-data":U.value},null,8,["visible","type","edit-data"])])]),_:1})])}}});export{He as default};
