import{a6 as d,a7 as g,r as h,au as E,p as r,S as n,av as p,d as y,aw as F,ax as b,M as C,ay as x,az as v,aA as _,e as f,o as B,f as D,i as k,n as M}from"./index-BZUOWCTQ.js";function m(t){return d({url:"/default/Menu/MenuTreeList?"+g.stringify(t)})}function R(t){return d({url:"/default/Menu",method:"post",data:t})}function q(t){return d({url:"/default/Menu/Edit",method:"post",data:t})}function $(t){return d({url:"/default/Menu/DelBatch",method:"post",data:t})}const A=p();function S(t){if(t){let s=t;for(let a=s.length;a--;a>0)s[a].children&&delete s[a].children;return s}}const O=async t=>{var s={Order:"order_no asc",pid:0,"name~!=":"home"};const a=await m(s);if(a.data)return a.data.push({id:"0",title:"顶级路由",icon:"mdi:arch"}),a.data=S(a.data),a.data.reverse()};function T({expose:t}){const s=async e=>{const u=await e;return e.param={Order:"order_no asc","title~%":u.title},u.title||delete e.param["title~%"],await m(e)},a=async({form:e,row:u})=>(e.id==null&&(e.id=u.id),await q(e)),c=async({form:e})=>await R(e),o=h([]);return{selectedIds:o,crudOptions:{container:{is:"fs-layout-card"},form:{wrapper:{width:"800px",draggable:!1,closeOnEsc:!1,maskClosable:!1}},search:{show:!0},actionbar:{show:!0},toolbar:{show:!0,buttons:{search:{show:!0},refresh:{show:!0},compact:{show:!0},export:{show:!0},columns:{show:!0}}},table:{scrollX:2500,bordered:!1,rowKey:e=>e.id,checkedRowKeys:o,"onUpdate:checkedRowKeys":e=>{o.value=e}},pagination:{show:!1},request:{pageRequest:s,addRequest:c,editRequest:a,transformQuery:async({page:e,form:u,sort:l})=>{const w=l==null?{}:{orderProp:l.prop,orderAsc:l.asc};return{page:e.currentPage,pageSize:e.pageSize,...u,...w}},transformRes:async({res:e})=>{const u=e.data;return await A.initAuthRoute(),{currentPage:1,pageSize:999999,total:1,records:u}}},rowHandle:{fixed:"right",align:"center",width:150,buttons:{view:{show:!0},edit:{show:!0},remove:{show:!1}}},columns:{_checked:{title:"选择",form:{show:!1},column:{type:"selection",align:"center",width:"55px",columnSetDisabled:!0}},pid:{title:"父级路由",type:"dict-select",dict:E({label:"title",value:"id",async getData({dict:e}){return await O()}}),search:{show:!1},column:{width:"150px"},form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请输入父级路由"}]}},title:{title:"路由标题",type:"text",search:{show:!0},form:{col:{span:12},rule:[{required:!0,message:"请输入路由标题"}]}},name:{title:"路由名称",type:"text",search:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请输入路由名称"}]}},path:{title:"路由地址",type:"text",search:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请输入路由地址"}]}},component:{title:"组件名称",type:"text",search:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请输入组件名称"}],helper:{render(){return r("p",{style:"color: red;"},[n("* $后加组件路径即可渲染此组件"),r("br",null,null),n("* 例如：(layout.base$view.home)"),r("br",null,null),n("* layout.base Base布局的顶级路由"),r("br",null,null),n("* layout.blank Blank布局的顶级路由"),r("br",null,null),n("* view. 组件路径"),r("br",null,null),n("* layout.base$ Base布局的组件路径"),r("br",null,null),n("* layout.blank$ Blank布局的组件路径")])}}}},href:{title:"外链地址",type:"text",search:{show:!1},column:{show:!1},form:{col:{span:12},helper:{render(){return r("p",{style:"color: red;"},[n("* 组件名称的值后加$view.iframe-page组件路径"),r("br",null,null),n("* 即可渲染iframe组件"),r("br",null,null),n("* 例如：layout.blank$view.iframe-page")])}}}},redirect:{title:"重定向",type:"text",search:{show:!1},column:{show:!1},form:{col:{span:12}}},icon:{title:"路由图标",type:"text",search:{show:!1},column:{align:"center",component:{name:"fs-icon",vModel:"icon",style:"font-size:18px"}},form:{col:{span:12},rule:[{required:!0,message:"请输入路由图标"}],helper:{render(){return r("a",{target:"_blank",href:"https://iconify.design/icon-sets/ion/"},[n("点击此处选择图标名称")])}}}},keepAlive:{title:"是否缓存",type:"dict-switch",search:{show:!1},column:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请选择是否缓存"}]}},hideInMenu:{title:"是否隐藏",type:"dict-switch",search:{show:!1},column:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请选择是否隐藏"}]}},i18nKey:{title:"国际化键值",type:"text",search:{show:!1},column:{show:!1},form:{col:{span:12}}},orderNo:{title:"排序",type:"text",search:{show:!1},form:{col:{span:12}}}}}}}const z=p(),P=y({name:"ComponentCrud",setup(){const t=h(),s=h(),{expose:a}=F({crudRef:t,crudBinding:s}),{crudOptions:c,selectedIds:o}=T({expose:a});b({expose:a,crudOptions:c}),C(()=>{a.doRefresh()});const i=x(),e=v();return{crudBinding:s,crudRef:t,handleBatchDelete:async()=>{var l;((l=o.value)==null?void 0:l.length)>0?await e.info({title:"确认",content:`确定要批量删除这${o.value.length}条记录吗`,positiveText:"确定",negativeText:"取消",async onPositiveClick(){await $(o.value),i.info("删除成功"),o.value=[],z.initAuthRoute(),await a.doRefresh()}}):i.error("请勾选要删除的记录")}}}}),K={class:"h-full"};function I(t,s,a,c,o,i){const e=f("fs-button"),u=f("fs-crud");return B(),D("div",K,[r(u,M({ref:"crudRef"},t.crudBinding),{"pagination-left":k(()=>[r(e,{icon:"ion:trash-outline",onClick:t.handleBatchDelete},null,8,["onClick"])]),_:1},16)])}const V=_(P,[["render",I]]);export{V as default};
