import{a6 as c,a7 as m,r as p,au as l,T as f,d as v,aw as _,ax as x,M as D,ay as E,az as P,aA as k,e as w,o as q,f as C,p as g,i as T,n as R}from"./index-BZUOWCTQ.js";function S(t){return c({url:"/default/User/Page?"+m.stringify(t)})}function B(t){return c({url:"/default/User/PcUser",method:"post",data:t})}function M(t){return c({url:"/default/User/Edit",method:"post",data:t})}function U(t){return c({url:"/default/User/DelBatch",method:"post",data:t})}const h=async t=>await c({url:"/default/Enum/EnumDataList",params:{EnumName:t}});function H(t){return c({url:"/default/Department/Tree?"+m.stringify(t)})}function L(t){return c({url:"/default/Post/List?"+m.stringify(t)})}const N=/^[1](([3][0-9])|([4][01456789])|([5][012356789])|([6][2567])|([7][0-8])|([8][0-9])|([9][012356789]))[0-9]{8}$/,Y=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,$=async()=>{const t=await h("AccountTypeEnum");if(t.data)return t.data},z=async()=>{const t=await h("StatusEnum");if(t.data)return t.data},O=async()=>{const t=await h("GenderEnum");if(t.data)return t.data},A=async()=>{const t=await L();if(t.data)return t.data},I=async()=>{const t=await H();if(t.data)return t.data};function y(t){if(t){let r=t;for(let s=r.length;s--;s>0)r[s].children&&(r[s].children.length?y(r[s].children):delete r[s].children);return r}}const G=async()=>await $(),K=async()=>await z(),X=async()=>await O(),j=async()=>await A(),Q=async()=>await I();function V({expose:t}){const r=async e=>{const a=await e;return e.param={Order:"id asc","account_type~=":a.accountType,"account~%":a.account,"nick_name~%":a.nickName,"phone~%":a.phone},a.accountType||delete e.param["account_type~="],a.account||delete e.param["account~%"],a.phone||delete e.param["phone~%"],a.nickName||delete e.param["nick_name~%"],await S(e)},s=async({form:e,row:a})=>(e.id==null&&(e.id=a.id),e.birthday=f(e.birthday).format("YYYY-MM-DD HH:mm:ss"),await M(e)),i=async({form:e})=>(e.birthday=f(e.birthday).format("YYYY-MM-DD HH:mm:ss"),await B(e)),n=p([]);return{selectedIds:n,crudOptions:{container:{is:"fs-layout-card"},form:{wrapper:{width:"800px",draggable:!1,closeOnEsc:!1,maskClosable:!1}},search:{show:!0},actionbar:{show:!0},toolbar:{show:!0,buttons:{search:{show:!0},refresh:{show:!0},compact:{show:!0},export:{show:!0},columns:{show:!0}}},table:{scrollX:2500,bordered:!1,rowKey:e=>e.id,checkedRowKeys:n,"onUpdate:checkedRowKeys":e=>{n.value=e}},pagination:{show:!0},request:{pageRequest:r,addRequest:i,editRequest:s,transformQuery:({page:e,form:a,sort:o})=>{const d=o==null?{}:{orderProp:o.prop,orderAsc:o.asc};return{page:e.currentPage,pageSize:e.pageSize,...a,...d}},transformRes:({res:e})=>{const a=e.data.list,o=e.data.totalPage,d=e.data.currentPage,b=e.data.pageSize;return{currentPage:d,pageSize:b,total:o,records:a}}},rowHandle:{fixed:"right",align:"center",width:150,buttons:{view:{show:!0},edit:{show:!0},remove:{show:!1}}},columns:{_checked:{title:"选择",form:{show:!1},column:{type:"selection",align:"center",width:"55px",columnSetDisabled:!0,disabled(e){return e.account==="admin"}}},accountType:{title:"账号类型",type:"dict-select",dict:l({label:"describe",value:"value",async getData({dict:e}){return await G()}}),search:{show:!0,col:{span:4},component:{clearable:!0}},column:{width:150},form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请选择账号类型"}]}},account:{title:"账号",type:"text",search:{show:!0,col:{span:"auto"}},column:{width:150},form:{col:{span:12},rule:[{required:!0,message:"请输入账号"}]}},departId:{title:"部门",type:"dict-cascader",dict:l({cloneable:!1,isTree:!0,label:"name",value:"id",async getData({dict:e}){return y(await Q())}}),search:{show:!1},column:{width:150},form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请选择部门"}]}},posId:{title:"职位",type:"dict-select",dict:l({label:"name",value:"id",async getData({dict:e}){return await j()}}),search:{show:!1},column:{width:150},form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请选择职位"}]}},nickName:{title:"昵称",type:"text",search:{show:!0,col:{span:"auto"}},column:{width:150},form:{col:{span:12},rule:[{required:!0,message:"请输入昵称"}]}},realName:{title:"真实姓名",type:"text",search:{show:!1},column:{show:!1},form:{col:{span:12},rule:[{required:!0,message:"请输入真实姓名"}]}},avatar:{title:"头像",type:"image-uploader",search:{show:!1},column:{width:150},form:{col:{span:24},rule:[{required:!0,message:"请输入头像"}],component:{limit:1,uploader:{type:"form",accept:".png,.jpeg,.jpg,.ico,.bmp,.gif,.webp,.svg"}},helper:"最大可上传1个文件"}},phone:{title:"手机号码",type:"text",search:{show:!0,col:{span:"auto"}},column:{width:150},form:{col:{span:12},rule:[{required:!0,message:"请输入手机号码"},{pattern:N,message:"手机号码错误",trigger:"input"}]}},email:{title:"邮箱",type:"text",search:{show:!1},column:{width:180},form:{col:{span:12},rule:[{required:!0,message:"请输入邮箱"},{pattern:Y,message:"邮箱格式错误",trigger:"input"}]}},sex:{title:"性别",type:"dict-select",search:{show:!1},column:{width:150},dict:l({label:"describe",value:"value",async getData({dict:e}){return await X()}}),form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请选择性别"}]}},age:{title:"年龄",type:"number",search:{show:!1},column:{width:150},form:{col:{span:12},rule:[{required:!0,message:"请输入年龄"}]}},nation:{title:"民族",type:"text",search:{show:!1},column:{width:150},form:{col:{span:12},rule:[{required:!0,message:"请输入民族"}]}},birthday:{title:"出生日期",type:"datetime",search:{show:!1},column:{width:200},form:{col:{span:12},rule:[{required:!0,message:"请输入出生日期"}],component:{format:"yyyy年MM月dd日 HH:mm"}}},status:{title:"状态",type:"dict-select",search:{show:!1},dict:l({label:"describe",value:"value",async getData({dict:e}){return await K()}}),column:{width:150},form:{component:{clearable:!1,multiple:!1},col:{span:12},rule:[{required:!0,message:"请选择状态"}]}},createTime:{title:"创建时间",type:"text",search:{show:!1},column:{width:200},form:{show:!1}}}}}}const F=v({name:"ComponentCrud",setup(){const t=p(),r=p(),{expose:s}=_({crudRef:t,crudBinding:r}),{crudOptions:i,selectedIds:n}=V({expose:s});x({expose:s,crudOptions:i}),D(()=>{s.doRefresh()});const u=E(),e=P();return{crudBinding:r,crudRef:t,handleBatchDelete:async()=>{var o;((o=n.value)==null?void 0:o.length)>0?await e.info({title:"确认",content:`确定要批量删除这${n.value.length}条记录吗`,positiveText:"确定",negativeText:"取消",async onPositiveClick(){await U(n.value),u.info("删除成功"),n.value=[],await s.doRefresh()}}):u.error("请勾选要删除的记录")}}}}),J={class:"h-full"};function W(t,r,s,i,n,u){const e=w("fs-button"),a=w("fs-crud");return q(),C("div",J,[g(a,R({ref:"crudRef"},t.crudBinding),{"pagination-left":T(()=>[g(e,{icon:"ion:trash-outline",onClick:t.handleBatchDelete},null,8,["onClick"])]),_:1},16)])}const ee=k(F,[["render",W]]);export{ee as default};
