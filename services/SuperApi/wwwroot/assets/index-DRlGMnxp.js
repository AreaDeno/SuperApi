import{g as G,a as q,b as R,c as F,d as X,e as Z,f as H,h as M,_ as Q,i as Y}from"./dynamic-gU_5PGvA.js";import{d as ee,r as d,B as w,Z as W,a0 as K,o as ae,f as le,p as n,i as p,g as b,V as m,X as ue,S as te,a1 as re,a2 as se,a3 as ne,a4 as pe,a5 as ie}from"./index-BZUOWCTQ.js";import{_ as de}from"./Space-CUMox7Fx.js";const ce={class:"overflow-hidden"},oe={class:"flex-col h-full"},ve=b("div",{class:"w-25"}," 实体对象：",-1),ye=b("div",{class:"w-25"}," Crud方式：",-1),me={class:"flex-col h-140"},be={class:"flex-col h-full"},Ke=ee({name:"dynamic_api",__name:"index",setup(ge){const x=d([]),u=d([]),s=d(""),c=d(""),a=d(""),C=d([{label:"等于",value:"=="},{label:"不等于",value:"!="},{label:"模糊查询",value:"%"},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="},{label:"In",value:"in"},{label:"NotIn",value:"!in"},{label:"左模糊",value:"ll"},{label:"右模糊",value:"lr"},{label:"IsNull",value:"null"},{label:"EquaNull",value:"=null"},{label:"NotNull",value:"not"},{label:"模糊取反",value:"noLike"},{label:"LikeOr",value:"inLike"}]),j=d([{label:"添加请求",value:"add"},{label:"修改请求",value:"edit"},{label:"删除请求",value:"del"},{label:"List条件请求",value:"list"},{label:"PageList分页条件请求",value:"page"},{label:"One单记录条件请求",value:"one"}]),L=d([{key:"key",title:"参数名",align:"center",render(t,l){return w(W,{key:l,value:t.pKey,disabled:!0,onUpdateValue(r){u.value[l].pKey=r}})}},{title:"查询条件",key:"pWhere",render(t,l){return c.value!=="add"&&c.value!=="edit"&&c.value!=="del"&&t.pKey!=="pageNum"&&t.pKey!=="pageSize"&&t.pKey!=="parentIdName"&&t.pKey!=="id"?w(K,{key:l,options:C.value,value:t.pWhere,height:"800px",onUpdateValue(r){u.value[l].pWhere=r}}):w(K,{key:l,options:C.value,value:t.pWhere,disabled:!0,onUpdateValue(r){u.value[l].pWhere=r}})}},{key:"value",title:"参数值",align:"center",render(t,l){return w(W,{key:l,value:t.pValue,onUpdateValue(r){u.value[l].pValue=r}})}}]),B=async t=>{switch(await $(s.value),t){case"edit":u.value.push({pKey:"id",pWhere:"",pValue:""});break;case"del":u.value=[],u.value.push({pKey:"id",pWhere:"",pValue:""});break;case"page":u.value.push({pKey:"pageNum",pWhere:"",pValue:1}),u.value.push({pKey:"pageSize",pWhere:"",pValue:10});break;case"tree":u.value.push({pKey:"parentIdName",pWhere:"",pValue:"Pid"});break;case"one":u.value=[],u.value.push({pKey:"id",pWhere:"",pValue:""});break}a.value=""},z=async()=>{const{data:t}=await Y();t&&t.forEach(l=>{x.value.push({label:l.tableName,value:l.id})})},A=async()=>{var t,l,r,g,_,v,o,f,i;if(!s.value){(t=window.$message)==null||t.error("请选择实体对象！");return}if(!c.value){(l=window.$message)==null||l.error("请选择Crud方式！");return}switch(c.value){case"add":let N={};u.value.forEach(e=>{e.pKey!=="Id"&&e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&Object.defineProperty(N,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0})});const O=await H({tableId:s.value,param:N});O.data.code===200&&((r=window.$message)==null||r.success(O.data.msg)),a.value="请求类型：POST",a.value+=`\r
请求参数：`+JSON.stringify(N,null,4),a.value+=`\r
响应结果：`+JSON.stringify(O,null,4);break;case"edit":let T={};u.value.forEach(e=>{e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&Object.defineProperty(T,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0})});const S=await Z({tableId:s.value,param:T});S.data.code===200&&((g=window.$message)==null||g.success(S.data.msg)),a.value=`请求类型：POST\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(T,null,4),a.value+=`\r
响应结果：`+JSON.stringify(S,null,4);break;case"del":let I={};u.value.forEach(e=>{e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&Object.defineProperty(I,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0})});const V=await X({tableId:s.value,param:I});V.data.code===200&&((_=window.$message)==null||_.success(V.data.msg)),a.value=`请求类型：POST\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(I,null,4),a.value+=`\r
响应结果：`+JSON.stringify(V,null,4);break;case"list":let k={};u.value.forEach(e=>{e.pKey!=="Id"&&e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&Object.defineProperty(k,e.pKey+"~"+e.pWhere,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0})});const J=await F({tableId:s.value,param:k});J.data.code===200&&((v=window.$message)==null||v.success(J.data.msg)),a.value=`请求类型：GET\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(k,null,4),a.value+=`\r
响应结果：`+JSON.stringify(J,null,4);break;case"page":let y={};u.value.forEach(e=>{e.pKey!=="Id"&&e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&(e.pKey==="pageNum"?Object.defineProperty(y,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0}):e.pKey==="pageSize"?Object.defineProperty(y,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(y,e.pKey+"~"+e.pWhere,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0}))});const P=await R({tableId:s.value,param:y});P.data.code===200&&((o=window.$message)==null||o.success(P.data.msg)),a.value=`请求类型：GET\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(y,null,4),a.value+=`\r
响应结果：`+JSON.stringify(P,null,4);break;case"tree":let h={};u.value.forEach(e=>{e.pKey!=="Id"&&e.pKey!=="CreateTime"&&e.pKey!=="UpdateTime"&&(e.pKey==="parentIdName"?Object.defineProperty(h,e.pKey,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(h,e.pKey+"~"+e.pWhere,{value:e.pValue,writable:!0,enumerable:!0,configurable:!0}))});const E=await q({tableId:s.value,param:h});E.data.code===200&&((f=window.$message)==null||f.success(E.data.msg)),a.value=`请求类型：GET\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(h,null,4),a.value+=`\r
响应结果：`+JSON.stringify(E,null,4);break;case"one":let D={};u.value.forEach(e=>{e.pKey==="id"&&Object.defineProperty(D,e.pKey+"~%",{value:e.pValue,writable:!0,enumerable:!0,configurable:!0})});const U=await G({tableId:s.value,param:D});U.data.code===200&&((i=window.$message)==null||i.success(U.data.msg)),a.value=`请求类型：GET\r
`,a.value+="请求数据表ID："+JSON.stringify(s.value,null,4),a.value+=`\r
请求参数：`+JSON.stringify(D,null,4),a.value+=`\r
响应结果：`+JSON.stringify(U,null,4);break}},$=async t=>{s.value=t;const l=await M({tableId:s.value});l.data&&(u.value=[],l.data.forEach(r=>{r.fieldName!=="Id"&&r.fieldName!=="CreateTime"&&r.fieldName!=="UpdateTime"&&u.value.push({pKey:r.fieldName,pWhere:"%",pValue:""})}))};return(async()=>{await z()})(),(t,l)=>{const r=re,g=Q,_=se,v=ne,o=pe,f=ie;return ae(),le("div",ce,[n(f,{cols:24,class:"h-full"},{default:p(()=>[n(o,{span:12},{default:p(()=>[n(v,{title:"动态API接口调试",bordered:!1,class:"h-full rounded-8px shadow-sm"},{default:p(()=>[b("div",oe,[n(m(de),{vertical:""},{default:p(()=>[n(r,null,{default:p(()=>[ve,n(m(K),{value:s.value,"onUpdate:value":[l[0]||(l[0]=i=>s.value=i),$],options:x.value},null,8,["value","options"])]),_:1}),n(r,null,{default:p(()=>[ye,n(m(K),{value:c.value,"onUpdate:value":l[1]||(l[1]=i=>c.value=i),options:j.value,onChange:B},null,8,["value","options"])]),_:1}),n(r,null,{default:p(()=>[n(m(ue),{class:"flex-1-hidden",type:"primary",onClick:A},{default:p(()=>[n(g,{class:"mr-4px text-20px"}),te(" 发送请求 ")]),_:1})]),_:1}),n(r,null,{default:p(()=>[b("div",me,[n(_,{columns:L.value,data:u.value,"flex-height":"",class:"flex-1-hidden"},null,8,["columns","data"])])]),_:1})]),_:1})])]),_:1})]),_:1}),n(o,{span:1}),n(o,{span:11},{default:p(()=>[n(v,{title:"动态API接口调试输出",bordered:!1,class:"h-full rounded-8px shadow-sm"},{default:p(()=>[b("div",be,[n(m(W),{type:"textarea",readonly:!0,value:a.value,"onUpdate:value":l[2]||(l[2]=i=>a.value=i),placeholder:"请求结果",autosize:{minRows:30,maxRows:30}},null,8,["value"])])]),_:1})]),_:1})]),_:1})])}}});export{Ke as default};
